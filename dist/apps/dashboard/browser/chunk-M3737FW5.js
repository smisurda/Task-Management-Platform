import{B as n,Ia as p,M as i,Ma as m,Qa as c,v as u,y as g,ya as s}from"./chunk-DCH6LNNV.js";var a="task_mgmt_token",l="task_mgmt_user",d=class o{constructor(e,t){this.http=e;this.router=t}token=i(this.getStoredToken());user=i(this.getStoredUser());isLoggedIn=s(()=>!!this.token());currentUser=s(()=>this.user());login(e,t){return this.http.post(`${c.apiUrl}/auth/login`,{email:e,password:t}).pipe(u(r=>{localStorage.setItem(a,r.access_token),localStorage.setItem(l,JSON.stringify(r.user)),this.token.set(r.access_token),this.user.set(r.user)}))}logout(){localStorage.removeItem(a),localStorage.removeItem(l),this.token.set(null),this.user.set(null),this.router.navigate(["/login"])}getToken(){return this.token()}getStoredToken(){return typeof localStorage>"u"?null:localStorage.getItem(a)}getStoredUser(){if(typeof localStorage>"u")return null;let e=localStorage.getItem(l);if(!e)return null;try{return JSON.parse(e)}catch{return null}}static \u0275fac=function(t){return new(t||o)(n(p),n(m))};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};export{d as a};
